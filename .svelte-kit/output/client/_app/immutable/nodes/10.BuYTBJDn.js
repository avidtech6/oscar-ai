import{U as Zt,s as zt,n as ye,d as u,l as n,i as q,b as r,u as ie,H as $t,c as i,e as g,g as D,h as c,j as I,B as el,p as Gt,C as tl,a as ce,f as J,t as Z,o as V,w as Ue,x as Re,S as It,m as ll,k as rl,r as mt,y as Nt,$ as at,F as vt,q as G,D as Ge,z as Qt,E as _t,v as Yt}from"../chunks/scheduler.DKaqMhG1.js";import{S as Kt,i as Wt,t as Ye,a as Qe,c as Xt,g as Jt,d as sl,m as nl,b as al,e as ol}from"../chunks/index.DlqHU1Qv.js";import{e as ot}from"../chunks/each.C2d3_RSt.js";import"../chunks/entry.Be3j---l.js";import{p as il}from"../chunks/stores.BFoXjtDT.js";import{d as ge}from"../chunks/index.BvaDNSI_.js";import{g as cl}from"../chunks/settings.a3gRd5qY.js";async function ul(s){var d;const e=Zt(cl);if(!e)throw new Error("Groq API key not configured. Please add it in Settings.");const t=new File([s],"recording.webm",{type:s.type||"audio/webm"}),l=new FormData;l.append("file",t),l.append("model","whisper-large-v3"),l.append("temperature","0"),l.append("response_format","json");const a=await fetch("https://api.groq.com/openai/v1/audio/transcriptions",{method:"POST",headers:{Authorization:`Bearer ${e}`},body:l});if(!a.ok){const m=((d=(await a.json().catch(()=>({}))).error)==null?void 0:d.message)||`Transcription failed: ${a.status}`;throw new Error(m)}const o=await a.json();return{text:o.text||"",language:o.language,duration:o.duration}}function dl(){const s=["audio/webm","audio/webm;codecs=opus","audio/webm;codecs=vp9","audio/ogg","audio/mp4","audio/mpeg","audio/wav"];for(const e of s)if(MediaRecorder.isTypeSupported(e))return e;return"audio/webm"}function At(s){let e,t,l;return{c(){e=c("div"),t=c("p"),l=Z(s[3]),this.h()},l(a){e=i(a,"DIV",{class:!0});var o=g(e);t=i(o,"P",{class:!0});var d=g(t);l=J(d,s[3]),d.forEach(u),o.forEach(u),this.h()},h(){n(t,"class","text-sm text-red-700"),n(e,"class","mb-3 p-3 bg-red-50 border border-red-200 rounded-lg")},m(a,o){q(a,e,o),r(e,t),r(t,l)},p(a,o){o&8&&ce(l,a[3])},d(a){a&&u(e)}}}function fl(s){let e,t;return{c(){e=Re("svg"),t=Re("path"),this.h()},l(l){e=Ue(l,"svg",{class:!0,fill:!0,stroke:!0,viewBox:!0});var a=g(e);t=Ue(a,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),g(t).forEach(u),a.forEach(u),this.h()},h(){n(t,"stroke-linecap","round"),n(t,"stroke-linejoin","round"),n(t,"stroke-width","2"),n(t,"d","M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"),n(e,"class","w-6 h-6 text-white"),n(e,"fill","none"),n(e,"stroke","currentColor"),n(e,"viewBox","0 0 24 24")},m(l,a){q(l,e,a),r(e,t)},d(l){l&&u(e)}}}function pl(s){let e,t,l;return{c(){e=Re("svg"),t=Re("circle"),l=Re("path"),this.h()},l(a){e=Ue(a,"svg",{class:!0,fill:!0,viewBox:!0});var o=g(e);t=Ue(o,"circle",{class:!0,cx:!0,cy:!0,r:!0,stroke:!0,"stroke-width":!0}),g(t).forEach(u),l=Ue(o,"path",{class:!0,fill:!0,d:!0}),g(l).forEach(u),o.forEach(u),this.h()},h(){n(t,"class","opacity-25"),n(t,"cx","12"),n(t,"cy","12"),n(t,"r","10"),n(t,"stroke","currentColor"),n(t,"stroke-width","4"),n(l,"class","opacity-75"),n(l,"fill","currentColor"),n(l,"d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"),n(e,"class","w-6 h-6 text-white animate-spin"),n(e,"fill","none"),n(e,"viewBox","0 0 24 24")},m(a,o){q(a,e,o),r(e,t),r(e,l)},d(a){a&&u(e)}}}function hl(s){let e,t;return{c(){e=Re("svg"),t=Re("rect"),this.h()},l(l){e=Ue(l,"svg",{class:!0,fill:!0,viewBox:!0});var a=g(e);t=Ue(a,"rect",{x:!0,y:!0,width:!0,height:!0,rx:!0}),g(t).forEach(u),a.forEach(u),this.h()},h(){n(t,"x","6"),n(t,"y","6"),n(t,"width","12"),n(t,"height","12"),n(t,"rx","2"),n(e,"class","w-6 h-6 text-white"),n(e,"fill","currentColor"),n(e,"viewBox","0 0 24 24")},m(l,a){q(l,e,a),r(e,t)},d(l){l&&u(e)}}}function Pt(s){let e;return{c(){e=c("span"),this.h()},l(t){e=i(t,"SPAN",{class:!0}),g(e).forEach(u),this.h()},h(){n(e,"class","absolute inset-0 rounded-full border-2 border-red-400 animate-ping opacity-50")},m(t,l){q(t,e,l)},d(t){t&&u(e)}}}function vl(s){let e,t="Click to start recording a voice note";return{c(){e=c("p"),e.textContent=t,this.h()},l(l){e=i(l,"P",{class:!0,"data-svelte-h":!0}),V(e)!=="svelte-1t6cycd"&&(e.textContent=t),this.h()},h(){n(e,"class","text-gray-600 text-sm")},m(l,a){q(l,e,a)},p:ye,d(l){l&&u(e)}}}function _l(s){let e,t,l="Recording",a,o,d=Bt(s[2])+"",y,m,h,v;return{c(){e=c("div"),t=c("span"),t.textContent=l,a=I(),o=c("span"),y=Z(d),m=I(),h=c("div"),v=c("div"),this.h()},l(f){e=i(f,"DIV",{class:!0});var p=g(e);t=i(p,"SPAN",{class:!0,"data-svelte-h":!0}),V(t)!=="svelte-erfvrk"&&(t.textContent=l),a=D(p),o=i(p,"SPAN",{class:!0});var w=g(o);y=J(w,d),w.forEach(u),p.forEach(u),m=D(f),h=i(f,"DIV",{class:!0});var P=g(h);v=i(P,"DIV",{class:!0,style:!0}),g(v).forEach(u),P.forEach(u),this.h()},h(){n(t,"class","text-red-600 font-bold animate-pulse"),n(o,"class","text-gray-600 font-mono bg-gray-100 px-2 py-1 rounded"),n(e,"class","flex items-center gap-3"),n(v,"class","h-full bg-red-500 transition-all duration-100"),It(v,"width",s[4]*100+"%"),n(h,"class","mt-1 h-1 bg-gray-200 rounded-full overflow-hidden")},m(f,p){q(f,e,p),r(e,t),r(e,a),r(e,o),r(o,y),q(f,m,p),q(f,h,p),r(h,v)},p(f,p){p&4&&d!==(d=Bt(f[2])+"")&&ce(y,d),p&16&&It(v,"width",f[4]*100+"%")},d(f){f&&(u(e),u(m),u(h))}}}function ml(s){let e,t='<span class="text-amber-600 font-medium">Transcribing...</span> <svg class="w-4 h-4 text-amber-600 animate-spin" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"></path></svg>';return{c(){e=c("div"),e.innerHTML=t,this.h()},l(l){e=i(l,"DIV",{class:!0,"data-svelte-h":!0}),V(e)!=="svelte-1nk0nj4"&&(e.innerHTML=t),this.h()},h(){n(e,"class","flex items-center gap-2")},m(l,a){q(l,e,a)},p:ye,d(l){l&&u(e)}}}function Lt(s){let e,t="Recording... Click the button again to stop. Max 5 minutes.";return{c(){e=c("p"),e.textContent=t,this.h()},l(l){e=i(l,"P",{class:!0,"data-svelte-h":!0}),V(e)!=="svelte-1ll678p"&&(e.textContent=t),this.h()},h(){n(e,"class","text-xs text-gray-500 mt-2")},m(l,a){q(l,e,a)},d(l){l&&u(e)}}}function gl(s){let e,t,l,a,o,d,y,m,h,v,f,p,w=s[3]&&At(s);function P(_,E){return _[0]?hl:_[1]?pl:fl}let L=P(s),A=L(s),B=s[0]&&Pt();function j(_,E){return _[1]?ml:_[0]?_l:vl}let T=j(s),C=T(s),k=s[0]&&Lt();return{c(){e=c("div"),w&&w.c(),t=I(),l=c("div"),a=c("button"),A.c(),o=I(),B&&B.c(),m=I(),h=c("div"),C.c(),v=I(),k&&k.c(),this.h()},l(_){e=i(_,"DIV",{class:!0});var E=g(e);w&&w.l(E),t=D(E),l=i(E,"DIV",{class:!0});var b=g(l);a=i(b,"BUTTON",{type:!0,class:!0});var x=g(a);A.l(x),o=D(x),B&&B.l(x),x.forEach(u),m=D(b),h=i(b,"DIV",{class:!0});var R=g(h);C.l(R),R.forEach(u),b.forEach(u),v=D(E),k&&k.l(E),E.forEach(u),this.h()},h(){n(a,"type","button"),a.disabled=d=s[1]||!navigator.mediaDevices,n(a,"class",y="relative w-14 h-14 rounded-full flex items-center justify-center transition-all duration-200 "+(s[0]?"bg-red-500 hover:bg-red-600 animate-pulse":"bg-forest-600 hover:bg-forest-700")+" "+(s[1]?"opacity-50 cursor-not-allowed":"")),n(h,"class","flex-1"),n(l,"class","flex items-center gap-4"),n(e,"class","voice-recorder svelte-1u50wob")},m(_,E){q(_,e,E),w&&w.m(e,null),r(e,t),r(e,l),r(l,a),A.m(a,null),r(a,o),B&&B.m(a,null),r(l,m),r(l,h),C.m(h,null),r(e,v),k&&k.m(e,null),f||(p=ie(a,"click",function(){$t(s[0]?s[6]:s[5])&&(s[0]?s[6]:s[5]).apply(this,arguments)}),f=!0)},p(_,[E]){s=_,s[3]?w?w.p(s,E):(w=At(s),w.c(),w.m(e,t)):w&&(w.d(1),w=null),L!==(L=P(s))&&(A.d(1),A=L(s),A&&(A.c(),A.m(a,o))),s[0]?B||(B=Pt(),B.c(),B.m(a,null)):B&&(B.d(1),B=null),E&2&&d!==(d=s[1]||!navigator.mediaDevices)&&(a.disabled=d),E&3&&y!==(y="relative w-14 h-14 rounded-full flex items-center justify-center transition-all duration-200 "+(s[0]?"bg-red-500 hover:bg-red-600 animate-pulse":"bg-forest-600 hover:bg-forest-700")+" "+(s[1]?"opacity-50 cursor-not-allowed":""))&&n(a,"class",y),T===(T=j(s))&&C?C.p(s,E):(C.d(1),C=T(s),C&&(C.c(),C.m(h,null))),s[0]?k||(k=Lt(),k.c(),k.m(e,null)):k&&(k.d(1),k=null)},i:ye,o:ye,d(_){_&&u(e),w&&w.d(),A.d(),B&&B.d(),C.d(),k&&k.d(),f=!1,p()}}}function Bt(s){const e=Math.floor(s/60),t=s%60;return`${e.toString().padStart(2,"0")}:${t.toString().padStart(2,"0")}`}function bl(s,e,t){let{projectId:l}=e;const a=el();let o=!1,d=!1,y=0,m="",h=null,v=[],f=null,p=null,w=0,P=null,L=null;Gt(()=>{(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)&&t(3,m="Voice recording is not supported in this browser.")}),tl(()=>{B(),p&&clearInterval(p),L&&cancelAnimationFrame(L)});async function A(){t(3,m="");try{f=await navigator.mediaDevices.getUserMedia({audio:{echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0}});const C=dl();h=new MediaRecorder(f,{mimeType:C}),v=[],h.ondataavailable=E=>{E.data.size>0&&v.push(E.data)},h.onstop=async()=>{const E=new Blob(v,{type:C});await j(E)};const k=new AudioContext,_=k.createMediaStreamSource(f);P=k.createAnalyser(),P.fftSize=256,_.connect(P),T(),h.start(100),t(0,o=!0),t(2,y=0),p=setInterval(()=>{t(2,y++,y),y>=300&&B()},1e3)}catch(C){console.error("Failed to start recording:",C),C instanceof Error?C.name==="NotAllowedError"?t(3,m="Microphone access denied. Please allow microphone access in your browser settings."):C.name==="NotFoundError"?t(3,m="No microphone found. Please connect a microphone and try again."):t(3,m=`Failed to start recording: ${C.message}`):t(3,m="Failed to start recording. Please check your microphone permissions.")}}function B(){h&&h.state!=="inactive"&&h.stop(),f&&(f.getTracks().forEach(C=>C.stop()),f=null),p&&(clearInterval(p),p=null),L&&(cancelAnimationFrame(L),L=null),t(0,o=!1)}async function j(C){if(v.length===0||C.size<100){t(3,m="Recording too short. Please try again.");return}t(1,d=!0),t(3,m="");try{const k=await ul(C);k.text&&k.text.trim()?a("transcript",{text:k.text.trim(),projectId:l}):t(3,m="No speech detected in recording. Please try again.")}catch(k){console.error("Transcription error:",k),k instanceof Error?t(3,m=k.message):t(3,m="Transcription failed. Please try again.")}finally{t(1,d=!1),t(2,y=0)}}function T(){if(!P)return;const C=new Uint8Array(P.frequencyBinCount);P.getByteFrequencyData(C);const k=C.reduce((_,E)=>_+E,0);t(4,w=k/C.length/255),o&&(L=requestAnimationFrame(T))}return s.$$set=C=>{"projectId"in C&&t(7,l=C.projectId)},[o,d,y,m,w,A,B,l]}class yl extends Kt{constructor(e){super(),Wt(this,e,bl,gl,zt,{projectId:7})}}function St(s,e,t){const l=s.slice();return l[34]=e[t],l}function Vt(s,e,t){const l=s.slice();return l[37]=e[t],l}function Ot(s){let e,t,l=s[1].clientName+"",a;return{c(){e=c("p"),t=Z("Client: "),a=Z(l),this.h()},l(o){e=i(o,"P",{class:!0});var d=g(e);t=J(d,"Client: "),a=J(d,l),d.forEach(u),this.h()},h(){n(e,"class","text-gray-600")},m(o,d){q(o,e,d),r(e,t),r(e,a)},p(o,d){d[0]&2&&l!==(l=o[1].clientName+"")&&ce(a,l)},d(o){o&&u(e)}}}function Ht(s){let e,t;return{c(){e=c("div"),t=Z(s[7]),this.h()},l(l){e=i(l,"DIV",{class:!0});var a=g(e);t=J(a,s[7]),a.forEach(u),this.h()},h(){n(e,"class","bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded mb-4")},m(l,a){q(l,e,a),r(e,t)},p(l,a){a[0]&128&&ce(t,l[7])},d(l){l&&u(e)}}}function xl(s){let e,t,l,a,o=s[2].length+"",d,y,m,h,v,f,p=s[3].length+"",w,P,L,A,B,j,T,C,k,_=s[4]==="trees"&&jt(s),E=s[4]==="notes"&&Ft(s);return{c(){e=c("div"),t=c("nav"),l=c("button"),a=Z("Trees ("),d=Z(o),y=Z(")"),h=I(),v=c("button"),f=Z("Notes ("),w=Z(p),P=Z(")"),A=I(),_&&_.c(),B=I(),E&&E.c(),j=Nt(),this.h()},l(b){e=i(b,"DIV",{class:!0});var x=g(e);t=i(x,"NAV",{class:!0});var R=g(t);l=i(R,"BUTTON",{class:!0});var Q=g(l);a=J(Q,"Trees ("),d=J(Q,o),y=J(Q,")"),Q.forEach(u),h=D(R),v=i(R,"BUTTON",{class:!0});var O=g(v);f=J(O,"Notes ("),w=J(O,p),P=J(O,")"),O.forEach(u),R.forEach(u),x.forEach(u),A=D(b),_&&_.l(b),B=D(b),E&&E.l(b),j=Nt(),this.h()},h(){n(l,"class",m="py-4 px-1 border-b-2 font-medium text-sm transition-colors "+(s[4]==="trees"?"border-forest-500 text-forest-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300")),n(v,"class",L="py-4 px-1 border-b-2 font-medium text-sm transition-colors "+(s[4]==="notes"?"border-forest-500 text-forest-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300")),n(t,"class","-mb-px flex space-x-8"),n(e,"class","border-b border-gray-200 mb-6")},m(b,x){q(b,e,x),r(e,t),r(t,l),r(l,a),r(l,d),r(l,y),r(t,h),r(t,v),r(v,f),r(v,w),r(v,P),q(b,A,x),_&&_.m(b,x),q(b,B,x),E&&E.m(b,x),q(b,j,x),T=!0,C||(k=[ie(l,"click",s[16]),ie(v,"click",s[17])],C=!0)},p(b,x){(!T||x[0]&4)&&o!==(o=b[2].length+"")&&ce(d,o),(!T||x[0]&16&&m!==(m="py-4 px-1 border-b-2 font-medium text-sm transition-colors "+(b[4]==="trees"?"border-forest-500 text-forest-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300")))&&n(l,"class",m),(!T||x[0]&8)&&p!==(p=b[3].length+"")&&ce(w,p),(!T||x[0]&16&&L!==(L="py-4 px-1 border-b-2 font-medium text-sm transition-colors "+(b[4]==="notes"?"border-forest-500 text-forest-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300")))&&n(v,"class",L),b[4]==="trees"?_?_.p(b,x):(_=jt(b),_.c(),_.m(B.parentNode,B)):_&&(_.d(1),_=null),b[4]==="notes"?E?(E.p(b,x),x[0]&16&&Qe(E,1)):(E=Ft(b),E.c(),Qe(E,1),E.m(j.parentNode,j)):E&&(Jt(),Ye(E,1,1,()=>{E=null}),Xt())},i(b){T||(Qe(E),T=!0)},o(b){Ye(E),T=!1},d(b){b&&(u(e),u(A),u(B),u(j)),_&&_.d(b),E&&E.d(b),C=!1,mt(k)}}}function wl(s){let e,t='<p class="text-gray-500">Project not found</p> <a href="/workspace" class="btn btn-primary mt-4">Back to Workspace</a>';return{c(){e=c("div"),e.innerHTML=t,this.h()},l(l){e=i(l,"DIV",{class:!0,"data-svelte-h":!0}),V(e)!=="svelte-1lpeqp6"&&(e.innerHTML=t),this.h()},h(){n(e,"class","text-center py-12")},m(l,a){q(l,e,a)},p:ye,i:ye,o:ye,d(l){l&&u(e)}}}function Cl(s){let e,t='<p class="text-gray-500">Loading project...</p>';return{c(){e=c("div"),e.innerHTML=t,this.h()},l(l){e=i(l,"DIV",{class:!0,"data-svelte-h":!0}),V(e)!=="svelte-18pbsxe"&&(e.innerHTML=t),this.h()},h(){n(e,"class","text-center py-12")},m(l,a){q(l,e,a)},p:ye,i:ye,o:ye,d(l){l&&u(e)}}}function jt(s){let e,t,l="Add New Tree",a,o,d,y,m="Tree No.",h,v,f,p,w,P="Species",L,A,B,j,T,C="Scientific Name",k,_,E,b,x,R="DBH (mm)",Q,O,$,Y,K,S="Height (m)",F,M,re,z,N,de="Age Class",se,te,he,W="Select...",ue,be="Young",H,ke="Semi-mature",fe,De="Mature",_e,Ee="Over-mature",le,U="Ancient",ee,pe,ve,Oe="Category",Le,ne,me,He="Select...",Ie,gt="A - High Quality",Ne,bt="B - Moderate Quality",Ae,yt="C - Low Quality",Pe,xt="U - Unsuitable",it,je,Be,wt="Condition",ct,xe,ut,Se,Ve,Ct="Notes",dt,we,ft,Me,kt='<button type="submit" class="btn btn-primary">Add Tree</button>',Ke,Te,qe,Et='<h2 class="text-lg font-semibold">Tree Survey</h2>',pt,ht,Tt;function Dt(X,ae){return X[2].length===0?El:kl}let We=Dt(s),Ce=We(s);return{c(){e=c("div"),t=c("h2"),t.textContent=l,a=I(),o=c("form"),d=c("div"),y=c("label"),y.textContent=m,h=I(),v=c("input"),f=I(),p=c("div"),w=c("label"),w.textContent=P,L=I(),A=c("input"),B=I(),j=c("div"),T=c("label"),T.textContent=C,k=I(),_=c("input"),E=I(),b=c("div"),x=c("label"),x.textContent=R,Q=I(),O=c("input"),$=I(),Y=c("div"),K=c("label"),K.textContent=S,F=I(),M=c("input"),re=I(),z=c("div"),N=c("label"),N.textContent=de,se=I(),te=c("select"),he=c("option"),he.textContent=W,ue=c("option"),ue.textContent=be,H=c("option"),H.textContent=ke,fe=c("option"),fe.textContent=De,_e=c("option"),_e.textContent=Ee,le=c("option"),le.textContent=U,ee=I(),pe=c("div"),ve=c("label"),ve.textContent=Oe,Le=I(),ne=c("select"),me=c("option"),me.textContent=He,Ie=c("option"),Ie.textContent=gt,Ne=c("option"),Ne.textContent=bt,Ae=c("option"),Ae.textContent=yt,Pe=c("option"),Pe.textContent=xt,it=I(),je=c("div"),Be=c("label"),Be.textContent=wt,ct=I(),xe=c("input"),ut=I(),Se=c("div"),Ve=c("label"),Ve.textContent=Ct,dt=I(),we=c("textarea"),ft=I(),Me=c("div"),Me.innerHTML=kt,Ke=I(),Te=c("div"),qe=c("div"),qe.innerHTML=Et,pt=I(),Ce.c(),this.h()},l(X){e=i(X,"DIV",{class:!0});var ae=g(e);t=i(ae,"H2",{class:!0,"data-svelte-h":!0}),V(t)!=="svelte-ee1a3o"&&(t.textContent=l),a=D(ae),o=i(ae,"FORM",{class:!0});var oe=g(o);d=i(oe,"DIV",{});var Xe=g(d);y=i(Xe,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),V(y)!=="svelte-kqpxe3"&&(y.textContent=m),h=D(Xe),v=i(Xe,"INPUT",{id:!0,type:!0,placeholder:!0,class:!0}),Xe.forEach(u),f=D(oe),p=i(oe,"DIV",{});var Je=g(p);w=i(Je,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),V(w)!=="svelte-msgy4h"&&(w.textContent=P),L=D(Je),A=i(Je,"INPUT",{id:!0,type:!0,placeholder:!0,class:!0}),Je.forEach(u),B=D(oe),j=i(oe,"DIV",{});var Ze=g(j);T=i(Ze,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),V(T)!=="svelte-w38sk1"&&(T.textContent=C),k=D(Ze),_=i(Ze,"INPUT",{id:!0,type:!0,placeholder:!0,class:!0}),Ze.forEach(u),E=D(oe),b=i(oe,"DIV",{});var $e=g(b);x=i($e,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),V(x)!=="svelte-vb282k"&&(x.textContent=R),Q=D($e),O=i($e,"INPUT",{id:!0,type:!0,placeholder:!0,class:!0}),$e.forEach(u),$=D(oe),Y=i(oe,"DIV",{});var et=g(Y);K=i(et,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),V(K)!=="svelte-96obd7"&&(K.textContent=S),F=D(et),M=i(et,"INPUT",{id:!0,type:!0,placeholder:!0,class:!0}),et.forEach(u),re=D(oe),z=i(oe,"DIV",{});var tt=g(z);N=i(tt,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),V(N)!=="svelte-1jgflfx"&&(N.textContent=de),se=D(tt),te=i(tt,"SELECT",{id:!0,class:!0});var Fe=g(te);he=i(Fe,"OPTION",{"data-svelte-h":!0}),V(he)!=="svelte-xkszye"&&(he.textContent=W),ue=i(Fe,"OPTION",{"data-svelte-h":!0}),V(ue)!=="svelte-j151n6"&&(ue.textContent=be),H=i(Fe,"OPTION",{"data-svelte-h":!0}),V(H)!=="svelte-16abx4s"&&(H.textContent=ke),fe=i(Fe,"OPTION",{"data-svelte-h":!0}),V(fe)!=="svelte-qhjpse"&&(fe.textContent=De),_e=i(Fe,"OPTION",{"data-svelte-h":!0}),V(_e)!=="svelte-k998h8"&&(_e.textContent=Ee),le=i(Fe,"OPTION",{"data-svelte-h":!0}),V(le)!=="svelte-qqannm"&&(le.textContent=U),Fe.forEach(u),tt.forEach(u),ee=D(oe),pe=i(oe,"DIV",{});var lt=g(pe);ve=i(lt,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),V(ve)!=="svelte-1hsecvb"&&(ve.textContent=Oe),Le=D(lt),ne=i(lt,"SELECT",{id:!0,class:!0});var ze=g(ne);me=i(ze,"OPTION",{"data-svelte-h":!0}),V(me)!=="svelte-xkszye"&&(me.textContent=He),Ie=i(ze,"OPTION",{"data-svelte-h":!0}),V(Ie)!=="svelte-14dxari"&&(Ie.textContent=gt),Ne=i(ze,"OPTION",{"data-svelte-h":!0}),V(Ne)!=="svelte-142daz5"&&(Ne.textContent=bt),Ae=i(ze,"OPTION",{"data-svelte-h":!0}),V(Ae)!=="svelte-pen2b8"&&(Ae.textContent=yt),Pe=i(ze,"OPTION",{"data-svelte-h":!0}),V(Pe)!=="svelte-b3qzud"&&(Pe.textContent=xt),ze.forEach(u),lt.forEach(u),it=D(oe),je=i(oe,"DIV",{});var rt=g(je);Be=i(rt,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),V(Be)!=="svelte-1n71yph"&&(Be.textContent=wt),ct=D(rt),xe=i(rt,"INPUT",{id:!0,type:!0,placeholder:!0,class:!0}),rt.forEach(u),ut=D(oe),Se=i(oe,"DIV",{class:!0});var st=g(Se);Ve=i(st,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),V(Ve)!=="svelte-p32nv1"&&(Ve.textContent=Ct),dt=D(st),we=i(st,"TEXTAREA",{id:!0,placeholder:!0,rows:!0,class:!0}),g(we).forEach(u),st.forEach(u),ft=D(oe),Me=i(oe,"DIV",{class:!0,"data-svelte-h":!0}),V(Me)!=="svelte-bj9ch"&&(Me.innerHTML=kt),oe.forEach(u),ae.forEach(u),Ke=D(X),Te=i(X,"DIV",{class:!0});var nt=g(Te);qe=i(nt,"DIV",{class:!0,"data-svelte-h":!0}),V(qe)!=="svelte-o8z3ul"&&(qe.innerHTML=Et),pt=D(nt),Ce.l(nt),nt.forEach(u),this.h()},h(){n(t,"class","text-lg font-semibold mb-4"),n(y,"for","treeNumber"),n(y,"class","block text-sm font-medium text-gray-700 mb-1"),n(v,"id","treeNumber"),n(v,"type","text"),n(v,"placeholder","e.g., T1"),n(v,"class","input w-full"),v.required=!0,n(w,"for","species"),n(w,"class","block text-sm font-medium text-gray-700 mb-1"),n(A,"id","species"),n(A,"type","text"),n(A,"placeholder","e.g., English Oak"),n(A,"class","input w-full"),A.required=!0,n(T,"for","scientificName"),n(T,"class","block text-sm font-medium text-gray-700 mb-1"),n(_,"id","scientificName"),n(_,"type","text"),n(_,"placeholder","e.g., Quercus robur"),n(_,"class","input w-full"),n(x,"for","DBH"),n(x,"class","block text-sm font-medium text-gray-700 mb-1"),n(O,"id","DBH"),n(O,"type","number"),n(O,"placeholder","e.g., 450"),n(O,"class","input w-full"),n(K,"for","height"),n(K,"class","block text-sm font-medium text-gray-700 mb-1"),n(M,"id","height"),n(M,"type","number"),n(M,"placeholder","e.g., 12"),n(M,"class","input w-full"),n(N,"for","age"),n(N,"class","block text-sm font-medium text-gray-700 mb-1"),he.__value="",G(he,he.__value),ue.__value="Young",G(ue,ue.__value),H.__value="Semi-mature",G(H,H.__value),fe.__value="Mature",G(fe,fe.__value),_e.__value="Over-mature",G(_e,_e.__value),le.__value="Ancient",G(le,le.__value),n(te,"id","age"),n(te,"class","input w-full"),s[8].age===void 0&&_t(()=>s[23].call(te)),n(ve,"for","category"),n(ve,"class","block text-sm font-medium text-gray-700 mb-1"),me.__value="",G(me,me.__value),Ie.__value="A",G(Ie,Ie.__value),Ne.__value="B",G(Ne,Ne.__value),Ae.__value="C",G(Ae,Ae.__value),Pe.__value="U",G(Pe,Pe.__value),n(ne,"id","category"),n(ne,"class","input w-full"),s[8].category===void 0&&_t(()=>s[24].call(ne)),n(Be,"for","condition"),n(Be,"class","block text-sm font-medium text-gray-700 mb-1"),n(xe,"id","condition"),n(xe,"type","text"),n(xe,"placeholder","e.g., Good"),n(xe,"class","input w-full"),n(Ve,"for","treeNotes"),n(Ve,"class","block text-sm font-medium text-gray-700 mb-1"),n(we,"id","treeNotes"),n(we,"placeholder","Additional observations..."),n(we,"rows","2"),n(we,"class","input w-full"),n(Se,"class","md:col-span-2 lg:col-span-4"),n(Me,"class","md:col-span-2 lg:col-span-4"),n(o,"class","grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"),n(e,"class","card p-6 mb-6"),n(qe,"class","p-4 border-b border-gray-200"),n(Te,"class","card")},m(X,ae){q(X,e,ae),r(e,t),r(e,a),r(e,o),r(o,d),r(d,y),r(d,h),r(d,v),G(v,s[8].number),r(o,f),r(o,p),r(p,w),r(p,L),r(p,A),G(A,s[8].species),r(o,B),r(o,j),r(j,T),r(j,k),r(j,_),G(_,s[8].scientificName),r(o,E),r(o,b),r(b,x),r(b,Q),r(b,O),G(O,s[8].DBH),r(o,$),r(o,Y),r(Y,K),r(Y,F),r(Y,M),G(M,s[8].height),r(o,re),r(o,z),r(z,N),r(z,se),r(z,te),r(te,he),r(te,ue),r(te,H),r(te,fe),r(te,_e),r(te,le),Ge(te,s[8].age,!0),r(o,ee),r(o,pe),r(pe,ve),r(pe,Le),r(pe,ne),r(ne,me),r(ne,Ie),r(ne,Ne),r(ne,Ae),r(ne,Pe),Ge(ne,s[8].category,!0),r(o,it),r(o,je),r(je,Be),r(je,ct),r(je,xe),G(xe,s[8].condition),r(o,ut),r(o,Se),r(Se,Ve),r(Se,dt),r(Se,we),G(we,s[8].notes),r(o,ft),r(o,Me),q(X,Ke,ae),q(X,Te,ae),r(Te,qe),r(Te,pt),Ce.m(Te,null),ht||(Tt=[ie(v,"input",s[18]),ie(A,"input",s[19]),ie(_,"input",s[20]),ie(O,"input",s[21]),ie(M,"input",s[22]),ie(te,"change",s[23]),ie(ne,"change",s[24]),ie(xe,"input",s[25]),ie(we,"input",s[26]),ie(o,"submit",Qt(s[11]))],ht=!0)},p(X,ae){ae[0]&256&&v.value!==X[8].number&&G(v,X[8].number),ae[0]&256&&A.value!==X[8].species&&G(A,X[8].species),ae[0]&256&&_.value!==X[8].scientificName&&G(_,X[8].scientificName),ae[0]&256&&at(O.value)!==X[8].DBH&&G(O,X[8].DBH),ae[0]&256&&at(M.value)!==X[8].height&&G(M,X[8].height),ae[0]&256&&Ge(te,X[8].age),ae[0]&256&&Ge(ne,X[8].category),ae[0]&256&&xe.value!==X[8].condition&&G(xe,X[8].condition),ae[0]&256&&G(we,X[8].notes),We===(We=Dt(X))&&Ce?Ce.p(X,ae):(Ce.d(1),Ce=We(X),Ce&&(Ce.c(),Ce.m(Te,null)))},d(X){X&&(u(e),u(Ke),u(Te)),Ce.d(),ht=!1,mt(Tt)}}}function kl(s){let e,t,l,a='<tr><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">No.</th> <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Species</th> <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">DBH</th> <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Height</th> <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Cat.</th> <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Condition</th> <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">RPA</th> <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th></tr>',o,d,y=ot(s[2]),m=[];for(let h=0;h<y.length;h+=1)m[h]=qt(Vt(s,y,h));return{c(){e=c("div"),t=c("table"),l=c("thead"),l.innerHTML=a,o=I(),d=c("tbody");for(let h=0;h<m.length;h+=1)m[h].c();this.h()},l(h){e=i(h,"DIV",{class:!0});var v=g(e);t=i(v,"TABLE",{class:!0});var f=g(t);l=i(f,"THEAD",{class:!0,"data-svelte-h":!0}),V(l)!=="svelte-2x6qyg"&&(l.innerHTML=a),o=D(f),d=i(f,"TBODY",{class:!0});var p=g(d);for(let w=0;w<m.length;w+=1)m[w].l(p);p.forEach(u),f.forEach(u),v.forEach(u),this.h()},h(){n(l,"class","bg-gray-50"),n(d,"class","bg-white divide-y divide-gray-200"),n(t,"class","min-w-full divide-y divide-gray-200"),n(e,"class","overflow-x-auto")},m(h,v){q(h,e,v),r(e,t),r(t,l),r(t,o),r(t,d);for(let f=0;f<m.length;f+=1)m[f]&&m[f].m(d,null)},p(h,v){if(v[0]&4100){y=ot(h[2]);let f;for(f=0;f<y.length;f+=1){const p=Vt(h,y,f);m[f]?m[f].p(p,v):(m[f]=qt(p),m[f].c(),m[f].m(d,null))}for(;f<m.length;f+=1)m[f].d(1);m.length=y.length}},d(h){h&&u(e),Yt(m,h)}}}function El(s){let e,t="<p>No trees added yet. Add your first tree above!</p>";return{c(){e=c("div"),e.innerHTML=t,this.h()},l(l){e=i(l,"DIV",{class:!0,"data-svelte-h":!0}),V(e)!=="svelte-1kd95gu"&&(e.innerHTML=t),this.h()},h(){n(e,"class","p-8 text-center text-gray-500")},m(l,a){q(l,e,a)},p:ye,d(l){l&&u(e)}}}function Mt(s){let e,t,l=s[37].scientificName+"",a,o;return{c(){e=c("span"),t=Z("("),a=Z(l),o=Z(")"),this.h()},l(d){e=i(d,"SPAN",{class:!0});var y=g(e);t=J(y,"("),a=J(y,l),o=J(y,")"),y.forEach(u),this.h()},h(){n(e,"class","text-gray-400 italic")},m(d,y){q(d,e,y),r(e,t),r(e,a),r(e,o)},p(d,y){y[0]&4&&l!==(l=d[37].scientificName+"")&&ce(a,l)},d(d){d&&u(e)}}}function qt(s){let e,t,l=s[37].number+"",a,o,d,y=s[37].species+"",m,h,v,f,p=s[37].DBH+"",w,P,L,A,B=s[37].height+"",j,T,C,k,_,E=(s[37].category||"-")+"",b,x,R,Q,O=(s[37].condition||"-")+"",$,Y,K,S=s[37].RPA+"",F,M,re,z,N,de="Delete",se,te,he,W=s[37].scientificName&&Mt(s);function ue(){return s[27](s[37])}return{c(){e=c("tr"),t=c("td"),a=Z(l),o=I(),d=c("td"),m=Z(y),h=I(),W&&W.c(),v=I(),f=c("td"),w=Z(p),P=Z("mm"),L=I(),A=c("td"),j=Z(B),T=Z("m"),C=I(),k=c("td"),_=c("span"),b=Z(E),R=I(),Q=c("td"),$=Z(O),Y=I(),K=c("td"),F=Z(S),M=Z("mm"),re=I(),z=c("td"),N=c("button"),N.textContent=de,se=I(),this.h()},l(be){e=i(be,"TR",{class:!0});var H=g(e);t=i(H,"TD",{class:!0});var ke=g(t);a=J(ke,l),ke.forEach(u),o=D(H),d=i(H,"TD",{class:!0});var fe=g(d);m=J(fe,y),h=D(fe),W&&W.l(fe),fe.forEach(u),v=D(H),f=i(H,"TD",{class:!0});var De=g(f);w=J(De,p),P=J(De,"mm"),De.forEach(u),L=D(H),A=i(H,"TD",{class:!0});var _e=g(A);j=J(_e,B),T=J(_e,"m"),_e.forEach(u),C=D(H),k=i(H,"TD",{class:!0});var Ee=g(k);_=i(Ee,"SPAN",{class:!0});var le=g(_);b=J(le,E),le.forEach(u),Ee.forEach(u),R=D(H),Q=i(H,"TD",{class:!0});var U=g(Q);$=J(U,O),U.forEach(u),Y=D(H),K=i(H,"TD",{class:!0});var ee=g(K);F=J(ee,S),M=J(ee,"mm"),ee.forEach(u),re=D(H),z=i(H,"TD",{class:!0});var pe=g(z);N=i(pe,"BUTTON",{class:!0,"data-svelte-h":!0}),V(N)!=="svelte-1s2c2c9"&&(N.textContent=de),pe.forEach(u),se=D(H),H.forEach(u),this.h()},h(){n(t,"class","px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"),n(d,"class","px-6 py-4 whitespace-nowrap text-sm text-gray-500"),n(f,"class","px-6 py-4 whitespace-nowrap text-sm text-gray-500"),n(A,"class","px-6 py-4 whitespace-nowrap text-sm text-gray-500"),n(_,"class",x="px-2 inline-flex text-xs leading-5 font-semibold rounded-full "+Rt(s[37].category)),n(k,"class","px-6 py-4 whitespace-nowrap"),n(Q,"class","px-6 py-4 whitespace-nowrap text-sm text-gray-500"),n(K,"class","px-6 py-4 whitespace-nowrap text-sm text-gray-500"),n(N,"class","text-red-600 hover:text-red-900"),n(z,"class","px-6 py-4 whitespace-nowrap text-right text-sm"),n(e,"class","hover:bg-gray-50")},m(be,H){q(be,e,H),r(e,t),r(t,a),r(e,o),r(e,d),r(d,m),r(d,h),W&&W.m(d,null),r(e,v),r(e,f),r(f,w),r(f,P),r(e,L),r(e,A),r(A,j),r(A,T),r(e,C),r(e,k),r(k,_),r(_,b),r(e,R),r(e,Q),r(Q,$),r(e,Y),r(e,K),r(K,F),r(K,M),r(e,re),r(e,z),r(z,N),r(e,se),te||(he=ie(N,"click",ue),te=!0)},p(be,H){s=be,H[0]&4&&l!==(l=s[37].number+"")&&ce(a,l),H[0]&4&&y!==(y=s[37].species+"")&&ce(m,y),s[37].scientificName?W?W.p(s,H):(W=Mt(s),W.c(),W.m(d,null)):W&&(W.d(1),W=null),H[0]&4&&p!==(p=s[37].DBH+"")&&ce(w,p),H[0]&4&&B!==(B=s[37].height+"")&&ce(j,B),H[0]&4&&E!==(E=(s[37].category||"-")+"")&&ce(b,E),H[0]&4&&x!==(x="px-2 inline-flex text-xs leading-5 font-semibold rounded-full "+Rt(s[37].category))&&n(_,"class",x),H[0]&4&&O!==(O=(s[37].condition||"-")+"")&&ce($,O),H[0]&4&&S!==(S=s[37].RPA+"")&&ce(F,S)},d(be){be&&u(e),W&&W.d(),te=!1,he()}}}function Ft(s){let e,t,l="Voice Note",a,o,d="Record a voice note and it will be automatically transcribed using AI.",y,m,h,v,f,p="Add New Note",w,P,L,A,B="Title",j,T,C,k,_,E="Type",b,x,R,Q="General",O,$="Field Note",Y,K="Voice Note",S,F,M,re="Content",z,N,de,se,te="Add Note",he,W,ue,be='<h2 class="text-lg font-semibold">Project Notes</h2>',H,ke,fe,De;m=new yl({props:{projectId:s[0]}}),m.$on("transcript",s[14]);function _e(U,ee){return U[3].length===0?Dl:Tl}let Ee=_e(s),le=Ee(s);return{c(){e=c("div"),t=c("h2"),t.textContent=l,a=I(),o=c("p"),o.textContent=d,y=I(),ol(m.$$.fragment),h=I(),v=c("div"),f=c("h2"),f.textContent=p,w=I(),P=c("form"),L=c("div"),A=c("label"),A.textContent=B,j=I(),T=c("input"),C=I(),k=c("div"),_=c("label"),_.textContent=E,b=I(),x=c("select"),R=c("option"),R.textContent=Q,O=c("option"),O.textContent=$,Y=c("option"),Y.textContent=K,S=I(),F=c("div"),M=c("label"),M.textContent=re,z=I(),N=c("textarea"),de=I(),se=c("button"),se.textContent=te,he=I(),W=c("div"),ue=c("div"),ue.innerHTML=be,H=I(),le.c(),this.h()},l(U){e=i(U,"DIV",{class:!0});var ee=g(e);t=i(ee,"H2",{class:!0,"data-svelte-h":!0}),V(t)!=="svelte-wplb7r"&&(t.textContent=l),a=D(ee),o=i(ee,"P",{class:!0,"data-svelte-h":!0}),V(o)!=="svelte-1810giw"&&(o.textContent=d),y=D(ee),al(m.$$.fragment,ee),ee.forEach(u),h=D(U),v=i(U,"DIV",{class:!0});var pe=g(v);f=i(pe,"H2",{class:!0,"data-svelte-h":!0}),V(f)!=="svelte-1y66x3c"&&(f.textContent=p),w=D(pe),P=i(pe,"FORM",{class:!0});var ve=g(P);L=i(ve,"DIV",{});var Oe=g(L);A=i(Oe,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),V(A)!=="svelte-q4wi6h"&&(A.textContent=B),j=D(Oe),T=i(Oe,"INPUT",{id:!0,type:!0,placeholder:!0,class:!0}),Oe.forEach(u),C=D(ve),k=i(ve,"DIV",{});var Le=g(k);_=i(Le,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),V(_)!=="svelte-1yx7gff"&&(_.textContent=E),b=D(Le),x=i(Le,"SELECT",{id:!0,class:!0});var ne=g(x);R=i(ne,"OPTION",{"data-svelte-h":!0}),V(R)!=="svelte-1m4wjg2"&&(R.textContent=Q),O=i(ne,"OPTION",{"data-svelte-h":!0}),V(O)!=="svelte-1oh4w6g"&&(O.textContent=$),Y=i(ne,"OPTION",{"data-svelte-h":!0}),V(Y)!=="svelte-i0h4ss"&&(Y.textContent=K),ne.forEach(u),Le.forEach(u),S=D(ve),F=i(ve,"DIV",{});var me=g(F);M=i(me,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),V(M)!=="svelte-gi0b65"&&(M.textContent=re),z=D(me),N=i(me,"TEXTAREA",{id:!0,placeholder:!0,rows:!0,class:!0}),g(N).forEach(u),me.forEach(u),de=D(ve),se=i(ve,"BUTTON",{type:!0,class:!0,"data-svelte-h":!0}),V(se)!=="svelte-kq9j4a"&&(se.textContent=te),ve.forEach(u),pe.forEach(u),he=D(U),W=i(U,"DIV",{class:!0});var He=g(W);ue=i(He,"DIV",{class:!0,"data-svelte-h":!0}),V(ue)!=="svelte-1ldzeoz"&&(ue.innerHTML=be),H=D(He),le.l(He),He.forEach(u),this.h()},h(){n(t,"class","text-lg font-semibold mb-4"),n(o,"class","text-sm text-gray-600 mb-4"),n(e,"class","card p-6 mb-6"),n(f,"class","text-lg font-semibold mb-4"),n(A,"for","noteTitle"),n(A,"class","block text-sm font-medium text-gray-700 mb-1"),n(T,"id","noteTitle"),n(T,"type","text"),n(T,"placeholder","Note title"),n(T,"class","input w-full"),T.required=!0,n(_,"for","noteType"),n(_,"class","block text-sm font-medium text-gray-700 mb-1"),R.__value="general",G(R,R.__value),O.__value="field",G(O,O.__value),Y.__value="voice",G(Y,Y.__value),n(x,"id","noteType"),n(x,"class","input w-full"),s[9].type===void 0&&_t(()=>s[29].call(x)),n(M,"for","noteContent"),n(M,"class","block text-sm font-medium text-gray-700 mb-1"),n(N,"id","noteContent"),n(N,"placeholder","Note content..."),n(N,"rows","4"),n(N,"class","input w-full"),N.required=!0,n(se,"type","submit"),n(se,"class","btn btn-primary"),n(P,"class","space-y-4"),n(v,"class","card p-6 mb-6"),n(ue,"class","p-4 border-b border-gray-200"),n(W,"class","card")},m(U,ee){q(U,e,ee),r(e,t),r(e,a),r(e,o),r(e,y),nl(m,e,null),q(U,h,ee),q(U,v,ee),r(v,f),r(v,w),r(v,P),r(P,L),r(L,A),r(L,j),r(L,T),G(T,s[9].title),r(P,C),r(P,k),r(k,_),r(k,b),r(k,x),r(x,R),r(x,O),r(x,Y),Ge(x,s[9].type,!0),r(P,S),r(P,F),r(F,M),r(F,z),r(F,N),G(N,s[9].content),r(P,de),r(P,se),q(U,he,ee),q(U,W,ee),r(W,ue),r(W,H),le.m(W,null),ke=!0,fe||(De=[ie(T,"input",s[28]),ie(x,"change",s[29]),ie(N,"input",s[30]),ie(P,"submit",Qt(s[13]))],fe=!0)},p(U,ee){const pe={};ee[0]&1&&(pe.projectId=U[0]),m.$set(pe),ee[0]&512&&T.value!==U[9].title&&G(T,U[9].title),ee[0]&512&&Ge(x,U[9].type),ee[0]&512&&G(N,U[9].content),Ee===(Ee=_e(U))&&le?le.p(U,ee):(le.d(1),le=Ee(U),le&&(le.c(),le.m(W,null)))},i(U){ke||(Qe(m.$$.fragment,U),ke=!0)},o(U){Ye(m.$$.fragment,U),ke=!1},d(U){U&&(u(e),u(h),u(v),u(he),u(W)),sl(m),le.d(),fe=!1,mt(De)}}}function Tl(s){let e,t=ot(s[3]),l=[];for(let a=0;a<t.length;a+=1)l[a]=Ut(St(s,t,a));return{c(){e=c("div");for(let a=0;a<l.length;a+=1)l[a].c();this.h()},l(a){e=i(a,"DIV",{class:!0});var o=g(e);for(let d=0;d<l.length;d+=1)l[d].l(o);o.forEach(u),this.h()},h(){n(e,"class","divide-y divide-gray-200")},m(a,o){q(a,e,o);for(let d=0;d<l.length;d+=1)l[d]&&l[d].m(e,null)},p(a,o){if(o[0]&32776){t=ot(a[3]);let d;for(d=0;d<t.length;d+=1){const y=St(a,t,d);l[d]?l[d].p(y,o):(l[d]=Ut(y),l[d].c(),l[d].m(e,null))}for(;d<l.length;d+=1)l[d].d(1);l.length=t.length}},d(a){a&&u(e),Yt(l,a)}}}function Dl(s){let e,t="<p>No notes added yet. Add your first note above!</p>";return{c(){e=c("div"),e.innerHTML=t,this.h()},l(l){e=i(l,"DIV",{class:!0,"data-svelte-h":!0}),V(e)!=="svelte-j738ua"&&(e.innerHTML=t),this.h()},h(){n(e,"class","p-8 text-center text-gray-500")},m(l,a){q(l,e,a)},p:ye,d(l){l&&u(e)}}}function Ut(s){let e,t,l,a,o,d=s[34].title+"",y,m,h,v=s[34].type+"",f,p,w,P,L=s[34].content+"",A,B,j,T=new Date(s[34].createdAt).toLocaleString()+"",C,k,_,E="Delete",b,x,R;function Q(){return s[31](s[34])}return{c(){e=c("div"),t=c("div"),l=c("div"),a=c("div"),o=c("h3"),y=Z(d),m=I(),h=c("span"),f=Z(v),w=I(),P=c("p"),A=Z(L),B=I(),j=c("p"),C=Z(T),k=I(),_=c("button"),_.textContent=E,b=I(),this.h()},l(O){e=i(O,"DIV",{class:!0});var $=g(e);t=i($,"DIV",{class:!0});var Y=g(t);l=i(Y,"DIV",{class:!0});var K=g(l);a=i(K,"DIV",{class:!0});var S=g(a);o=i(S,"H3",{class:!0});var F=g(o);y=J(F,d),F.forEach(u),m=D(S),h=i(S,"SPAN",{class:!0});var M=g(h);f=J(M,v),M.forEach(u),S.forEach(u),w=D(K),P=i(K,"P",{class:!0});var re=g(P);A=J(re,L),re.forEach(u),B=D(K),j=i(K,"P",{class:!0});var z=g(j);C=J(z,T),z.forEach(u),K.forEach(u),k=D(Y),_=i(Y,"BUTTON",{class:!0,"data-svelte-h":!0}),V(_)!=="svelte-efqtbv"&&(_.textContent=E),Y.forEach(u),b=D($),$.forEach(u),this.h()},h(){n(o,"class","text-lg font-medium text-gray-900"),n(h,"class",p="px-2 py-0.5 text-xs rounded-full "+(s[34].type==="field"?"bg-green-100 text-green-800":s[34].type==="voice"?"bg-purple-100 text-purple-800":"bg-gray-100 text-gray-800")),n(a,"class","flex items-center gap-2 mb-1"),n(P,"class","text-gray-600 whitespace-pre-wrap"),n(j,"class","text-xs text-gray-400 mt-2"),n(l,"class","flex-1 min-w-0"),n(_,"class","ml-4 text-red-600 hover:text-red-900"),n(t,"class","flex items-start justify-between"),n(e,"class","p-4 hover:bg-gray-50")},m(O,$){q(O,e,$),r(e,t),r(t,l),r(l,a),r(a,o),r(o,y),r(a,m),r(a,h),r(h,f),r(l,w),r(l,P),r(P,A),r(l,B),r(l,j),r(j,C),r(t,k),r(t,_),r(e,b),x||(R=ie(_,"click",Q),x=!0)},p(O,$){s=O,$[0]&8&&d!==(d=s[34].title+"")&&ce(y,d),$[0]&8&&v!==(v=s[34].type+"")&&ce(f,v),$[0]&8&&p!==(p="px-2 py-0.5 text-xs rounded-full "+(s[34].type==="field"?"bg-green-100 text-green-800":s[34].type==="voice"?"bg-purple-100 text-purple-800":"bg-gray-100 text-gray-800"))&&n(h,"class",p),$[0]&8&&L!==(L=s[34].content+"")&&ce(A,L),$[0]&8&&T!==(T=new Date(s[34].createdAt).toLocaleString()+"")&&ce(C,T)},d(O){O&&u(e),x=!1,R()}}}function Il(s){var $,Y,K;let e,t,l,a,o,d,y="â† Back to Workspace",m,h,v=((($=s[1])==null?void 0:$.name)||"Loading...")+"",f,p,w,P,L=s[6]?"Saving...":"Save",A,B,j,T,C,k,_,E;document.title=e=(((Y=s[1])==null?void 0:Y.name)||"Project")+" - Oscar AI";let b=((K=s[1])==null?void 0:K.clientName)&&Ot(s),x=s[7]&&Ht(s);const R=[Cl,wl,xl],Q=[];function O(S,F){return S[5]?0:S[1]?2:1}return T=O(s),C=Q[T]=R[T](s),{c(){t=I(),l=c("div"),a=c("div"),o=c("div"),d=c("a"),d.textContent=y,m=I(),h=c("h1"),f=Z(v),p=I(),b&&b.c(),w=I(),P=c("button"),A=Z(L),B=I(),x&&x.c(),j=I(),C.c(),this.h()},l(S){ll("svelte-1gbzigf",document.head).forEach(u),t=D(S),l=i(S,"DIV",{class:!0});var M=g(l);a=i(M,"DIV",{class:!0});var re=g(a);o=i(re,"DIV",{});var z=g(o);d=i(z,"A",{href:!0,class:!0,"data-svelte-h":!0}),V(d)!=="svelte-s78gz6"&&(d.textContent=y),m=D(z),h=i(z,"H1",{class:!0});var N=g(h);f=J(N,v),N.forEach(u),p=D(z),b&&b.l(z),z.forEach(u),w=D(re),P=i(re,"BUTTON",{class:!0});var de=g(P);A=J(de,L),de.forEach(u),re.forEach(u),B=D(M),x&&x.l(M),j=D(M),C.l(M),M.forEach(u),this.h()},h(){n(d,"href","/workspace"),n(d,"class","text-sm text-forest-600 hover:underline mb-1 inline-block"),n(h,"class","text-2xl font-bold text-gray-900"),P.disabled=s[6],n(P,"class","btn btn-primary"),n(a,"class","mb-6 flex items-center justify-between"),n(l,"class","max-w-6xl mx-auto")},m(S,F){q(S,t,F),q(S,l,F),r(l,a),r(a,o),r(o,d),r(o,m),r(o,h),r(h,f),r(o,p),b&&b.m(o,null),r(a,w),r(a,P),r(P,A),r(l,B),x&&x.m(l,null),r(l,j),Q[T].m(l,null),k=!0,_||(E=ie(P,"click",s[10]),_=!0)},p(S,F){var re,z,N;(!k||F[0]&2)&&e!==(e=(((re=S[1])==null?void 0:re.name)||"Project")+" - Oscar AI")&&(document.title=e),(!k||F[0]&2)&&v!==(v=(((z=S[1])==null?void 0:z.name)||"Loading...")+"")&&ce(f,v),(N=S[1])!=null&&N.clientName?b?b.p(S,F):(b=Ot(S),b.c(),b.m(o,null)):b&&(b.d(1),b=null),(!k||F[0]&64)&&L!==(L=S[6]?"Saving...":"Save")&&ce(A,L),(!k||F[0]&64)&&(P.disabled=S[6]),S[7]?x?x.p(S,F):(x=Ht(S),x.c(),x.m(l,j)):x&&(x.d(1),x=null);let M=T;T=O(S),T===M?Q[T].p(S,F):(Jt(),Ye(Q[M],1,1,()=>{Q[M]=null}),Xt(),C=Q[T],C?C.p(S,F):(C=Q[T]=R[T](S),C.c()),Qe(C,1),C.m(l,null))},i(S){k||(Qe(C),k=!0)},o(S){Ye(C),k=!1},d(S){S&&(u(t),u(l)),b&&b.d(),x&&x.d(),Q[T].d(),_=!1,E()}}}function Rt(s){switch(s){case"A":return"bg-green-100 text-green-800";case"B":return"bg-blue-100 text-blue-800";case"C":return"bg-yellow-100 text-yellow-800";case"U":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}}function Nl(s,e,t){let l;rl(s,il,N=>t(32,l=N));let a="",o,d=[],y=[],m="trees",h=!0,v=!1,f="",p={number:"",species:"",scientificName:"",DBH:0,height:0,age:"",category:"",condition:"",notes:""},w={title:"",content:"",type:"general"};Gt(async()=>{t(0,a=l.params.id),await P()});async function P(){t(5,h=!0),t(7,f="");try{if(t(1,o=await ge.projects.get(a)),!o){t(7,f="Project not found");return}t(2,d=await ge.trees.where("projectId").equals(a).toArray()),t(3,y=await ge.notes.where("projectId").equals(a).toArray())}catch(N){t(7,f="Failed to load project"),console.error(N)}finally{t(5,h=!1)}}async function L(){t(6,v=!0),t(7,f="");try{await ge.projects.update(a,{updatedAt:new Date().toISOString()})}catch(N){t(7,f="Failed to save"),console.error(N)}finally{t(6,v=!1)}}async function A(){if(!(!p.number||!p.species))try{const N=await ge.trees.add({projectId:a,number:p.number,species:p.species,scientificName:p.scientificName,DBH:p.DBH,height:p.height,age:p.age,category:p.category,condition:p.condition,notes:p.notes,RPA:p.DBH*12,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()});t(2,d=await ge.trees.where("projectId").equals(a).toArray()),t(8,p={number:"",species:"",scientificName:"",DBH:0,height:0,age:"",category:"",condition:"",notes:""}),await L()}catch(N){t(7,f="Failed to add tree"),console.error(N)}}async function B(N){if(confirm("Are you sure you want to delete this tree?"))try{await ge.trees.delete(N),t(2,d=await ge.trees.where("projectId").equals(a).toArray()),await L()}catch(de){t(7,f="Failed to delete tree"),console.error(de)}}async function j(){if(!(!w.title||!w.content))try{await ge.notes.add({projectId:a,title:w.title,content:w.content,type:w.type,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}),t(3,y=await ge.notes.where("projectId").equals(a).toArray()),t(9,w={title:"",content:"",type:"general"}),await L()}catch(N){t(7,f="Failed to add note"),console.error(N)}}async function T(N){const{text:de}=N.detail;try{const se=new Date,te=`Voice Note - ${se.toLocaleDateString("en-GB")} ${se.toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"})}`;await ge.notes.add({projectId:a,title:te,content:de,type:"voice",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}),t(3,y=await ge.notes.where("projectId").equals(a).toArray()),await L()}catch(se){t(7,f="Failed to save voice note"),console.error(se)}}async function C(N){if(confirm("Are you sure you want to delete this note?"))try{await ge.notes.delete(N),t(3,y=await ge.notes.where("projectId").equals(a).toArray()),await L()}catch(de){t(7,f="Failed to delete note"),console.error(de)}}const k=()=>t(4,m="trees"),_=()=>t(4,m="notes");function E(){p.number=this.value,t(8,p)}function b(){p.species=this.value,t(8,p)}function x(){p.scientificName=this.value,t(8,p)}function R(){p.DBH=at(this.value),t(8,p)}function Q(){p.height=at(this.value),t(8,p)}function O(){p.age=vt(this),t(8,p)}function $(){p.category=vt(this),t(8,p)}function Y(){p.condition=this.value,t(8,p)}function K(){p.notes=this.value,t(8,p)}const S=N=>N.id&&B(N.id);function F(){w.title=this.value,t(9,w)}function M(){w.type=vt(this),t(9,w)}function re(){w.content=this.value,t(9,w)}return[a,o,d,y,m,h,v,f,p,w,L,A,B,j,T,C,k,_,E,b,x,R,Q,O,$,Y,K,S,F,M,re,N=>N.id&&C(N.id)]}class Hl extends Kt{constructor(e){super(),Wt(this,e,Nl,Il,zt,{},null,[-1,-1])}}export{Hl as component};
