import{s as ne,n as Q,d as f,r as ie,q as $,a as K,i as U,b as n,u as X,l as c,m as ce,g as M,c as h,e as w,o as J,f as x,j as P,h as p,t as q,p as de,v as fe}from"../chunks/scheduler.DKaqMhG1.js";import{e as ee}from"../chunks/each.C2d3_RSt.js";import{S as ue,i as he}from"../chunks/index.DlqHU1Qv.js";import{g as pe}from"../chunks/entry.Be3j---l.js";import{d as g}from"../chunks/index.BvaDNSI_.js";function te(a,t,r){const e=a.slice();return e[10]=t[r],e}function re(a){let t,r;return{c(){t=p("p"),r=q(a[2]),this.h()},l(e){t=h(e,"P",{class:!0});var s=w(t);r=x(s,a[2]),s.forEach(f),this.h()},h(){c(t,"class","text-red-600 text-sm mt-2")},m(e,s){U(e,t,s),n(t,r)},p(e,s){s&4&&K(r,e[2])},d(e){e&&f(t)}}}function me(a){let t,r=ee(a[0]),e=[];for(let s=0;s<r.length;s+=1)e[s]=ae(te(a,r,s));return{c(){t=p("div");for(let s=0;s<e.length;s+=1)e[s].c();this.h()},l(s){t=h(s,"DIV",{class:!0});var o=w(t);for(let l=0;l<e.length;l+=1)e[l].l(o);o.forEach(f),this.h()},h(){c(t,"class","divide-y divide-gray-200")},m(s,o){U(s,t,o);for(let l=0;l<e.length;l+=1)e[l]&&e[l].m(t,null)},p(s,o){if(o&65){r=ee(s[0]);let l;for(l=0;l<r.length;l+=1){const y=te(s,r,l);e[l]?e[l].p(y,o):(e[l]=ae(y),e[l].c(),e[l].m(t,null))}for(;l<e.length;l+=1)e[l].d(1);e.length=r.length}},d(s){s&&f(t),fe(e,s)}}}function _e(a){let t,r='<p class="mb-4">No projects yet. Create your first project above!</p>';return{c(){t=p("div"),t.innerHTML=r,this.h()},l(e){t=h(e,"DIV",{class:!0,"data-svelte-h":!0}),J(t)!=="svelte-17tddck"&&(t.innerHTML=r),this.h()},h(){c(t,"class","p-8 text-center text-gray-500")},m(e,s){U(e,t,s)},p:Q,d(e){e&&f(t)}}}function ve(a){let t,r="<p>Loading projects...</p>";return{c(){t=p("div"),t.innerHTML=r,this.h()},l(e){t=h(e,"DIV",{class:!0,"data-svelte-h":!0}),J(t)!=="svelte-nt24bw"&&(t.innerHTML=r),this.h()},h(){c(t,"class","p-8 text-center text-gray-500")},m(e,s){U(e,t,s)},p:Q,d(e){e&&f(t)}}}function le(a){let t,r,e=a[10].clientName+"",s;return{c(){t=p("p"),r=q("Client: "),s=q(e),this.h()},l(o){t=h(o,"P",{class:!0});var l=w(t);r=x(l,"Client: "),s=x(l,e),l.forEach(f),this.h()},h(){c(t,"class","text-sm text-gray-500 truncate")},m(o,l){U(o,t,l),n(t,r),n(t,s)},p(o,l){l&1&&e!==(e=o[10].clientName+"")&&K(s,e)},d(o){o&&f(t)}}}function se(a){let t,r,e=a[10].siteAddress+"",s;return{c(){t=p("p"),r=q("Site: "),s=q(e),this.h()},l(o){t=h(o,"P",{class:!0});var l=w(t);r=x(l,"Site: "),s=x(l,e),l.forEach(f),this.h()},h(){c(t,"class","text-sm text-gray-500 truncate")},m(o,l){U(o,t,l),n(t,r),n(t,s)},p(o,l){l&1&&e!==(e=o[10].siteAddress+"")&&K(s,e)},d(o){o&&f(t)}}}function ae(a){let t,r,e,s,o=a[10].name+"",l,y,F,V,_,j,S=oe(a[10].createdAt)+"",i,C,O,k,D,I,E,L,H,G='<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg>',R,Y,v,b=a[10].clientName&&le(a),m=a[10].siteAddress&&se(a);function T(){return a[8](a[10])}return{c(){t=p("div"),r=p("div"),e=p("a"),s=p("h3"),l=q(o),y=P(),b&&b.c(),F=P(),m&&m.c(),V=P(),_=p("p"),j=q("Created: "),i=q(S),O=P(),k=p("div"),D=p("a"),I=q("Open"),L=P(),H=p("button"),H.innerHTML=G,R=P(),this.h()},l(d){t=h(d,"DIV",{class:!0});var u=w(t);r=h(u,"DIV",{class:!0});var N=w(r);e=h(N,"A",{href:!0,class:!0});var A=w(e);s=h(A,"H3",{class:!0});var W=w(s);l=x(W,o),W.forEach(f),y=M(A),b&&b.l(A),F=M(A),m&&m.l(A),V=M(A),_=h(A,"P",{class:!0});var z=w(_);j=x(z,"Created: "),i=x(z,S),z.forEach(f),A.forEach(f),O=M(N),k=h(N,"DIV",{class:!0});var B=w(k);D=h(B,"A",{href:!0,class:!0});var Z=w(D);I=x(Z,"Open"),Z.forEach(f),L=M(B),H=h(B,"BUTTON",{class:!0,title:!0,"data-svelte-h":!0}),J(H)!=="svelte-18u25p"&&(H.innerHTML=G),B.forEach(f),N.forEach(f),R=M(u),u.forEach(f),this.h()},h(){c(s,"class","text-lg font-medium text-gray-900 truncate"),c(_,"class","text-xs text-gray-400 mt-1"),c(e,"href",C="/project/"+a[10].id),c(e,"class","flex-1 min-w-0"),c(D,"href",E="/project/"+a[10].id),c(D,"class","btn btn-secondary text-sm"),c(H,"class","p-2 text-red-600 hover:bg-red-50 rounded transition-colors"),c(H,"title","Delete project"),c(k,"class","ml-4 flex items-center gap-2"),c(r,"class","flex items-center justify-between"),c(t,"class","p-4 hover:bg-gray-50 transition-colors")},m(d,u){U(d,t,u),n(t,r),n(r,e),n(e,s),n(s,l),n(e,y),b&&b.m(e,null),n(e,F),m&&m.m(e,null),n(e,V),n(e,_),n(_,j),n(_,i),n(r,O),n(r,k),n(k,D),n(D,I),n(k,L),n(k,H),n(t,R),Y||(v=X(H,"click",T),Y=!0)},p(d,u){a=d,u&1&&o!==(o=a[10].name+"")&&K(l,o),a[10].clientName?b?b.p(a,u):(b=le(a),b.c(),b.m(e,F)):b&&(b.d(1),b=null),a[10].siteAddress?m?m.p(a,u):(m=se(a),m.c(),m.m(e,V)):m&&(m.d(1),m=null),u&1&&S!==(S=oe(a[10].createdAt)+"")&&K(i,S),u&1&&C!==(C="/project/"+a[10].id)&&c(e,"href",C),u&1&&E!==(E="/project/"+a[10].id)&&c(D,"href",E)},d(d){d&&f(t),b&&b.d(),m&&m.d(),Y=!1,v()}}}function be(a){let t,r,e,s='<h1 class="text-2xl font-bold text-gray-900 mb-2">Workspace</h1> <p class="text-gray-600">Manage your arboricultural projects</p>',o,l,y,F="Create New Project",V,_,j,S,i,C=a[4]?"Creating...":"Create Project",O,k,D,I,E,L,H='<h2 class="text-lg font-semibold">Your Projects</h2>',G,R,Y,v=a[2]&&re(a);function b(d,u){return d[1]?ve:d[0].length===0?_e:me}let m=b(a),T=m(a);return{c(){t=P(),r=p("div"),e=p("div"),e.innerHTML=s,o=P(),l=p("div"),y=p("h2"),y.textContent=F,V=P(),_=p("form"),j=p("input"),S=P(),i=p("button"),O=q(C),D=P(),v&&v.c(),I=P(),E=p("div"),L=p("div"),L.innerHTML=H,G=P(),T.c(),this.h()},l(d){ce("svelte-fg38a0",document.head).forEach(f),t=M(d),r=h(d,"DIV",{class:!0});var N=w(r);e=h(N,"DIV",{class:!0,"data-svelte-h":!0}),J(e)!=="svelte-1n56o2y"&&(e.innerHTML=s),o=M(N),l=h(N,"DIV",{class:!0});var A=w(l);y=h(A,"H2",{class:!0,"data-svelte-h":!0}),J(y)!=="svelte-vhkw6k"&&(y.textContent=F),V=M(A),_=h(A,"FORM",{class:!0});var W=w(_);j=h(W,"INPUT",{type:!0,placeholder:!0,class:!0}),S=M(W),i=h(W,"BUTTON",{type:!0,class:!0});var z=w(i);O=x(z,C),z.forEach(f),W.forEach(f),D=M(A),v&&v.l(A),A.forEach(f),I=M(N),E=h(N,"DIV",{class:!0});var B=w(E);L=h(B,"DIV",{class:!0,"data-svelte-h":!0}),J(L)!=="svelte-1x6bblm"&&(L.innerHTML=H),G=M(B),T.l(B),B.forEach(f),N.forEach(f),this.h()},h(){document.title="Workspace - Oscar AI",c(e,"class","mb-8"),c(y,"class","text-lg font-semibold mb-4"),c(j,"type","text"),c(j,"placeholder","Project name (e.g., Oakwood Development)"),c(j,"class","input flex-1"),c(i,"type","submit"),i.disabled=k=a[4]||!a[3].trim(),c(i,"class","btn btn-primary"),c(_,"class","flex gap-3"),c(l,"class","card p-6 mb-8"),c(L,"class","p-4 border-b border-gray-200"),c(E,"class","card"),c(r,"class","max-w-6xl mx-auto")},m(d,u){U(d,t,u),U(d,r,u),n(r,e),n(r,o),n(r,l),n(l,y),n(l,V),n(l,_),n(_,j),$(j,a[3]),n(_,S),n(_,i),n(i,O),n(l,D),v&&v.m(l,null),n(r,I),n(r,E),n(E,L),n(E,G),T.m(E,null),R||(Y=[X(j,"input",a[7]),X(_,"submit",a[5])],R=!0)},p(d,[u]){u&8&&j.value!==d[3]&&$(j,d[3]),u&16&&C!==(C=d[4]?"Creating...":"Create Project")&&K(O,C),u&24&&k!==(k=d[4]||!d[3].trim())&&(i.disabled=k),d[2]?v?v.p(d,u):(v=re(d),v.c(),v.m(l,null)):v&&(v.d(1),v=null),m===(m=b(d))&&T?T.p(d,u):(T.d(1),T=m(d),T&&(T.c(),T.m(E,null)))},i:Q,o:Q,d(d){d&&(f(t),f(r)),v&&v.d(),T.d(),R=!1,ie(Y)}}}function oe(a){return new Date(a).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"})}function ge(a,t,r){let e=[],s=!0,o="",l="",y=!1;de(async()=>{try{r(0,e=await g.projects.toArray())}catch(i){r(2,o="Failed to load projects"),console.error(i)}finally{r(1,s=!1)}});async function F(){if(l.trim()){r(4,y=!0),r(2,o="");try{const i=await g.projects.add({name:l.trim(),clientName:"",siteAddress:"",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),rootFolderId:"",driveFolderId:""});r(0,e=await g.projects.toArray()),r(3,l=""),pe(`/project/${i}`)}catch(i){r(2,o="Failed to create project"),console.error(i)}finally{r(4,y=!1)}}}function V(i){i.preventDefault(),F()}async function _(i){if(confirm(`Are you sure you want to delete "${i.name}"? This cannot be undone.`))try{await g.transaction("rw",[g.projects,g.trees,g.notes,g.photos,g.reports],async()=>{const C=await g.trees.where("projectId").equals(i.id).toArray();for(const I of C)await g.trees.delete(I.id);const O=await g.notes.where("projectId").equals(i.id).toArray();for(const I of O)await g.notes.delete(I.id);const k=await g.photos.where("projectId").equals(i.id).toArray();for(const I of k)await g.photos.delete(I.id);const D=await g.reports.where("projectId").equals(i.id).toArray();for(const I of D)await g.reports.delete(I.id);await g.projects.delete(i.id)}),r(0,e=await g.projects.toArray())}catch(C){r(2,o="Failed to delete project"),console.error(C)}}function j(){l=this.value,r(3,l)}return[e,s,o,l,y,V,_,j,i=>_(i)]}class Ae extends ue{constructor(t){super(),he(this,t,ge,be,ne,{})}}export{Ae as component};
